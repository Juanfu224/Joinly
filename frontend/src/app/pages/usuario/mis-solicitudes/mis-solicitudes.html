<div class="p-mis-solicitudes">
  <header class="p-mis-solicitudes__header">
    <h1 class="p-mis-solicitudes__title">Mis Solicitudes</h1>
    <p class="p-mis-solicitudes__description">
      Gestiona tus solicitudes de unión a grupos y suscripciones
    </p>
  </header>

  <section class="p-mis-solicitudes__filters">
    <div class="p-mis-solicitudes__filter-group">
      <button
        type="button"
        class="p-mis-solicitudes__filter-btn"
        [class.p-mis-solicitudes__filter-btn--active]="filtroEstado() === undefined"
        (click)="onFiltroChange('TODAS')">
        Todas
      </button>
      <button
        type="button"
        class="p-mis-solicitudes__filter-btn"
        [class.p-mis-solicitudes__filter-btn--active]="filtroEstado() === 'PENDIENTE'"
        (click)="onFiltroChange('PENDIENTE')">
        Pendientes
      </button>
      <button
        type="button"
        class="p-mis-solicitudes__filter-btn"
        [class.p-mis-solicitudes__filter-btn--active]="filtroEstado() === 'APROBADA'"
        (click)="onFiltroChange('APROBADA')">
        Aprobadas
      </button>
      <button
        type="button"
        class="p-mis-solicitudes__filter-btn"
        [class.p-mis-solicitudes__filter-btn--active]="filtroEstado() === 'RECHAZADA'"
        (click)="onFiltroChange('RECHAZADA')">
        Rechazadas
      </button>
    </div>
  </section>

  <app-tabs class="p-mis-solicitudes__tabs">
    <app-tab title="Grupos">
      @if (haySolicitudesGrupos()) {
        <div class="p-mis-solicitudes__grid">
          @for (solicitud of solicitudesGrupos(); track solicitud.id) {
            <app-solicitud-card
              [solicitud]="solicitud"
              (cancel)="onCancelarSolicitud(solicitud.id)" />
          }
        </div>
      } @else {
        <app-card class="p-mis-solicitudes__empty">
          <p class="p-mis-solicitudes__empty-text">
            @if (filtroEstado()) {
              No tienes solicitudes de grupos con el estado seleccionado
            } @else {
              No has enviado ninguna solicitud de unión a grupos
            }
          </p>
        </app-card>
      }
    </app-tab>

    <app-tab title="Suscripciones">
      @if (haySolicitudesSuscripciones()) {
        <div class="p-mis-solicitudes__grid">
          @for (solicitud of solicitudesSuscripciones(); track solicitud.id) {
            <app-solicitud-card
              [solicitud]="solicitud"
              (cancel)="onCancelarSolicitud(solicitud.id)" />
          }
        </div>
      } @else {
        <app-card class="p-mis-solicitudes__empty">
          <p class="p-mis-solicitudes__empty-text">
            @if (filtroEstado()) {
              No tienes solicitudes de suscripciones con el estado seleccionado
            } @else {
              No has enviado ninguna solicitud de unión a suscripciones
            }
          </p>
        </app-card>
      }
    </app-tab>
  </app-tabs>

  @if (isLoading()) {
    <app-spinner-overlay />
  }
</div>
