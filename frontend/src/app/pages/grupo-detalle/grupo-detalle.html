<main class="p-grupo-detalle">
  <!-- Breadcrumbs de navegaci贸n -->
  <div class="l-contenedor">
    <app-breadcrumbs [items]="breadcrumbs()" />
  </div>

  <div class="l-contenedor">
    <!-- Estado de carga -->
    @if (isLoading()) {
      <div class="p-grupo-detalle__loading" aria-label="Cargando grupo">
        <!-- Skeleton header -->
        <div class="p-grupo-detalle__skeleton-header">
          <div class="p-grupo-detalle__skeleton-titulo"></div>
          <div class="p-grupo-detalle__skeleton-subtitulo"></div>
        </div>
        <!-- Skeleton miembros -->
        <div class="p-grupo-detalle__skeleton-seccion"></div>
        <!-- Skeleton suscripciones -->
        <div class="p-grupo-detalle__skeleton-seccion p-grupo-detalle__skeleton-seccion--grande"></div>
      </div>
    } @else if (error()) {
      <!-- Estado de error -->
      <section class="p-grupo-detalle__error" aria-label="Error al cargar">
        <div class="p-grupo-detalle__error-content">
          <app-icon name="alert-triangle" size="lg" />
          <p class="p-grupo-detalle__error-text">{{ error() }}</p>
          <app-button variant="primary" (click)="onReintentar()">
            Reintentar
          </app-button>
        </div>
      </section>
    } @else {
      <!-- Header del grupo -->
      <header class="p-grupo-detalle__header">
        <div class="p-grupo-detalle__header-info">
          <h1 class="p-grupo-detalle__titulo">{{ grupo()?.nombre }}</h1>
          <p class="p-grupo-detalle__subtitulo">
            Gestiona suscripciones o crea alguna
          </p>
        </div>
        <app-button 
          variant="blue" 
          leftIcon="add"
          (click)="onInvitar()"
        >
          Invitar
        </app-button>
      </header>

      <!-- Secci贸n de miembros -->
      <section class="p-grupo-detalle__miembros" aria-labelledby="titulo-miembros">
        <app-member-list [members]="membersData()" />
      </section>

      <!-- Secci贸n de suscripciones -->
      <section class="p-grupo-detalle__suscripciones" aria-labelledby="titulo-suscripciones">
        <header class="p-grupo-detalle__suscripciones-header">
          <h2 id="titulo-suscripciones" class="p-grupo-detalle__suscripciones-titulo">
            Tus suscripciones
          </h2>
          <app-button 
            variant="purple"
            (click)="onCrearSuscripcion()"
          >
            Crear suscripci贸n
          </app-button>
        </header>

        <div class="p-grupo-detalle__suscripciones-content">
          @if (hasSuscripciones()) {
            <div class="p-grupo-detalle__suscripciones-grid">
              @for (suscripcion of suscripcionCards(); track suscripcion.id) {
                <app-subscription-card
                  [suscripcion]="suscripcion"
                  (viewDetails)="onSuscripcionClick(suscripcion.id)"
                />
              }
            </div>
          } @else {
            <app-empty-subscriptions />
          }
        </div>
      </section>
    }
  </div>
</main>
