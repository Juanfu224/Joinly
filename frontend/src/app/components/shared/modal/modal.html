<!-- Modal solo se renderiza si está abierto -->
@if (modalService.isOpen()) {
  <!-- Overlay oscuro de fondo -->
  <div 
    class="c-modal__overlay" 
    (click)="handleOverlayClick($event)"
    aria-hidden="true"
  ></div>

  <!-- Contenedor del modal (centrado en pantalla) -->
  <div 
    class="c-modal__contenedor"
    role="dialog"
    aria-modal="true"
    [attr.aria-labelledby]="modalService.config()?.title ? 'modal-title' : null"
    [attr.aria-describedby]="'modal-content'"
  >
    <!-- Contenido del modal -->
    <div 
      #modalContent
      class="c-modal__contenido"
      (click)="preventClose($event)"
    >
      <!-- Botón de cerrar (X) en la esquina superior derecha -->
      <button
        type="button"
        class="c-modal__cerrar"
        (click)="handleCancel()"
        aria-label="Cerrar modal"
      >
        <app-icon name="close" size="sm" />
      </button>

      <!-- Título del modal (opcional) -->
      @if (modalService.config()?.title) {
        <h2 id="modal-title" class="c-modal__titulo">
          {{ modalService.config()!.title }}
        </h2>
      }

      <!-- Contenido del modal -->
      <div id="modal-content" class="c-modal__texto" [innerHTML]="sanitizedContent()">
      </div>

      <!-- Acciones (botones) -->
      <div class="c-modal__acciones">
        <!-- Botón de cancelar (solo si se proporciona cancelText) -->
        @if (modalService.config()?.cancelText) {
          <app-button 
            variant="secondary" 
            size="md"
            (click)="handleCancel()"
          >
            {{ modalService.config()!.cancelText }}
          </app-button>
        }

        <!-- Botón de confirmar -->
        <app-button 
          variant="primary" 
          size="md"
          (click)="handleConfirm()"
        >
          {{ modalService.config()!.confirmText }}
        </app-button>
      </div>
    </div>
  </div>

  <!-- Trigger para detectar cuando el modal se abre -->
  {{ onModalOpened() }}
}
